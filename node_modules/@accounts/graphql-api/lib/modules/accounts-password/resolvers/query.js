"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var password_1 = require("@accounts/password");
exports.Query = {
    twoFactorSecret: function (_, args, ctx) { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
        var user, injector, secret;
        return tslib_1.__generator(this, function (_a) {
            user = ctx.user, injector = ctx.injector;
            // Make sure user is logged in
            if (!(user && user.id)) {
                throw new Error('Unauthorized');
            }
            secret = injector.get(password_1.AccountsPassword).twoFactor.getNewAuthSecret();
            return [2 /*return*/, secret];
        });
    }); },
};
//# sourceMappingURL=query.js.map